// Code generated by hertz generator.

package users

import (
	"context"

	"files/pkg/common"
	users "files/pkg/hertz/biz/model/api/users"
	"files/pkg/integration"

	"github.com/cloudwego/hertz/pkg/app"
	"github.com/cloudwego/hertz/pkg/protocol/consts"
)

// UsersMethod .
// @router /api/users/ [GET]
func UsersMethod(ctx context.Context, c *app.RequestContext) {
	var usersdata = integration.IntegrationService.GetUsers()
	var owner = string(c.GetHeader(common.REQUEST_HEADER_OWNER))

	resp := &users.UsersResp{
		Data: new(users.UsersData),
	}
	var olaresId string
	var usersNodes []*users.UsersNode
	for _, v := range usersdata {
		if v.Name == owner {
			olaresId = v.OlaresId
		}
		var u = &users.UsersNode{
			Name:     v.Name,
			Role:     v.Role,
			OlaresId: v.OlaresId,
			Status:   v.Status,
		}
		usersNodes = append(usersNodes, u)
	}

	resp.Data.Owner = owner
	resp.Data.OlaresId = olaresId
	resp.Data.Users = usersNodes

	c.JSON(consts.StatusOK, resp)
}
